.text
# sbox table
	li t0, 0x63
	sb t0, 0
	li t0, 0x7c
	sb t0, 1
	li t0, 0x77
	sb t0, 2
	li t0, 0x7b
	sb t0, 3
	li t0, 0xf2
	sb t0, 4
	li t0, 0x6b
	sb t0, 5
	li t0, 0x6f
	sb t0, 6
	li t0, 0xc5
	sb t0, 7
	li t0, 0x30
	sb t0, 8
	li t0, 0x1
	sb t0, 9
	li t0, 0x67
	sb t0, 10
	li t0, 0x2b
	sb t0, 11
	li t0, 0xfe
	sb t0, 12
	li t0, 0xd7
	sb t0, 13
	li t0, 0xab
	sb t0, 14
	li t0, 0x76
	sb t0, 15
	li t0, 0xca
	sb t0, 16
	li t0, 0x82
	sb t0, 17
	li t0, 0xc9
	sb t0, 18
	li t0, 0x7d
	sb t0, 19
	li t0, 0xfa
	sb t0, 20
	li t0, 0x59
	sb t0, 21
	li t0, 0x47
	sb t0, 22
	li t0, 0xf0
	sb t0, 23
	li t0, 0xad
	sb t0, 24
	li t0, 0xd4
	sb t0, 25
	li t0, 0xa2
	sb t0, 26
	li t0, 0xaf
	sb t0, 27
	li t0, 0x9c
	sb t0, 28
	li t0, 0xa4
	sb t0, 29
	li t0, 0x72
	sb t0, 30
	li t0, 0xc0
	sb t0, 31
	li t0, 0xb7
	sb t0, 32
	li t0, 0xfd
	sb t0, 33
	li t0, 0x93
	sb t0, 34
	li t0, 0x26
	sb t0, 35
	li t0, 0x36
	sb t0, 36
	li t0, 0x3f
	sb t0, 37
	li t0, 0xf7
	sb t0, 38
	li t0, 0xcc
	sb t0, 39
	li t0, 0x34
	sb t0, 40
	li t0, 0xa5
	sb t0, 41
	li t0, 0xe5
	sb t0, 42
	li t0, 0xf1
	sb t0, 43
	li t0, 0x71
	sb t0, 44
	li t0, 0xd8
	sb t0, 45
	li t0, 0x31
	sb t0, 46
	li t0, 0x15
	sb t0, 47
	li t0, 0x4
	sb t0, 48
	li t0, 0xc7
	sb t0, 49
	li t0, 0x23
	sb t0, 50
	li t0, 0xc3
	sb t0, 51
	li t0, 0x18
	sb t0, 52
	li t0, 0x96
	sb t0, 53
	li t0, 0x5
	sb t0, 54
	li t0, 0x9a
	sb t0, 55
	li t0, 0x7
	sb t0, 56
	li t0, 0x12
	sb t0, 57
	li t0, 0x80
	sb t0, 58
	li t0, 0xe2
	sb t0, 59
	li t0, 0xeb
	sb t0, 60
	li t0, 0x27
	sb t0, 61
	li t0, 0xb2
	sb t0, 62
	li t0, 0x75
	sb t0, 63
	li t0, 0x9
	sb t0, 64
	li t0, 0x83
	sb t0, 65
	li t0, 0x2c
	sb t0, 66
	li t0, 0x1a
	sb t0, 67
	li t0, 0x1b
	sb t0, 68
	li t0, 0x6e
	sb t0, 69
	li t0, 0x5a
	sb t0, 70
	li t0, 0xa0
	sb t0, 71
	li t0, 0x52
	sb t0, 72
	li t0, 0x3b
	sb t0, 73
	li t0, 0xd6
	sb t0, 74
	li t0, 0xb3
	sb t0, 75
	li t0, 0x29
	sb t0, 76
	li t0, 0xe3
	sb t0, 77
	li t0, 0x2f
	sb t0, 78
	li t0, 0x84
	sb t0, 79
	li t0, 0x53
	sb t0, 80
	li t0, 0xd1
	sb t0, 81
	li t0, 0x0
	sb t0, 82
	li t0, 0xed
	sb t0, 83
	li t0, 0x20
	sb t0, 84
	li t0, 0xfc
	sb t0, 85
	li t0, 0xb1
	sb t0, 86
	li t0, 0x5b
	sb t0, 87
	li t0, 0x6a
	sb t0, 88
	li t0, 0xcb
	sb t0, 89
	li t0, 0xbe
	sb t0, 90
	li t0, 0x39
	sb t0, 91
	li t0, 0x4a
	sb t0, 92
	li t0, 0x4c
	sb t0, 93
	li t0, 0x58
	sb t0, 94
	li t0, 0xcf
	sb t0, 95
	li t0, 0xd0
	sb t0, 96
	li t0, 0xef
	sb t0, 97
	li t0, 0xaa
	sb t0, 98
	li t0, 0xfb
	sb t0, 99
	li t0, 0x43
	sb t0, 100
	li t0, 0x4d
	sb t0, 101
	li t0, 0x33
	sb t0, 102
	li t0, 0x85
	sb t0, 103
	li t0, 0x45
	sb t0, 104
	li t0, 0xf9
	sb t0, 105
	li t0, 0x2
	sb t0, 106
	li t0, 0x7f
	sb t0, 107
	li t0, 0x50
	sb t0, 108
	li t0, 0x3c
	sb t0, 109
	li t0, 0x9f
	sb t0, 110
	li t0, 0xa8
	sb t0, 111
	li t0, 0x51
	sb t0, 112
	li t0, 0xa3
	sb t0, 113
	li t0, 0x40
	sb t0, 114
	li t0, 0x8f
	sb t0, 115
	li t0, 0x92
	sb t0, 116
	li t0, 0x9d
	sb t0, 117
	li t0, 0x38
	sb t0, 118
	li t0, 0xf5
	sb t0, 119
	li t0, 0xbc
	sb t0, 120
	li t0, 0xb6
	sb t0, 121
	li t0, 0xda
	sb t0, 122
	li t0, 0x21
	sb t0, 123
	li t0, 0x10
	sb t0, 124
	li t0, 0xff
	sb t0, 125
	li t0, 0xf3
	sb t0, 126
	li t0, 0xd2
	sb t0, 127
	li t0, 0xcd
	sb t0, 128
	li t0, 0xc
	sb t0, 129
	li t0, 0x13
	sb t0, 130
	li t0, 0xec
	sb t0, 131
	li t0, 0x5f
	sb t0, 132
	li t0, 0x97
	sb t0, 133
	li t0, 0x44
	sb t0, 134
	li t0, 0x17
	sb t0, 135
	li t0, 0xc4
	sb t0, 136
	li t0, 0xa7
	sb t0, 137
	li t0, 0x7e
	sb t0, 138
	li t0, 0x3d
	sb t0, 139
	li t0, 0x64
	sb t0, 140
	li t0, 0x5d
	sb t0, 141
	li t0, 0x19
	sb t0, 142
	li t0, 0x73
	sb t0, 143
	li t0, 0x60
	sb t0, 144
	li t0, 0x81
	sb t0, 145
	li t0, 0x4f
	sb t0, 146
	li t0, 0xdc
	sb t0, 147
	li t0, 0x22
	sb t0, 148
	li t0, 0x2a
	sb t0, 149
	li t0, 0x90
	sb t0, 150
	li t0, 0x88
	sb t0, 151
	li t0, 0x46
	sb t0, 152
	li t0, 0xee
	sb t0, 153
	li t0, 0xb8
	sb t0, 154
	li t0, 0x14
	sb t0, 155
	li t0, 0xde
	sb t0, 156
	li t0, 0x5e
	sb t0, 157
	li t0, 0xb
	sb t0, 158
	li t0, 0xdb
	sb t0, 159
	li t0, 0xe0
	sb t0, 160
	li t0, 0x32
	sb t0, 161
	li t0, 0x3a
	sb t0, 162
	li t0, 0xa
	sb t0, 163
	li t0, 0x49
	sb t0, 164
	li t0, 0x6
	sb t0, 165
	li t0, 0x24
	sb t0, 166
	li t0, 0x5c
	sb t0, 167
	li t0, 0xc2
	sb t0, 168
	li t0, 0xd3
	sb t0, 169
	li t0, 0xac
	sb t0, 170
	li t0, 0x62
	sb t0, 171
	li t0, 0x91
	sb t0, 172
	li t0, 0x95
	sb t0, 173
	li t0, 0xe4
	sb t0, 174
	li t0, 0x79
	sb t0, 175
	li t0, 0xe7
	sb t0, 176
	li t0, 0xc8
	sb t0, 177
	li t0, 0x37
	sb t0, 178
	li t0, 0x6d
	sb t0, 179
	li t0, 0x8d
	sb t0, 180
	li t0, 0xd5
	sb t0, 181
	li t0, 0x4e
	sb t0, 182
	li t0, 0xa9
	sb t0, 183
	li t0, 0x6c
	sb t0, 184
	li t0, 0x56
	sb t0, 185
	li t0, 0xf4
	sb t0, 186
	li t0, 0xea
	sb t0, 187
	li t0, 0x65
	sb t0, 188
	li t0, 0x7a
	sb t0, 189
	li t0, 0xae
	sb t0, 190
	li t0, 0x8
	sb t0, 191
	li t0, 0xba
	sb t0, 192
	li t0, 0x78
	sb t0, 193
	li t0, 0x25
	sb t0, 194
	li t0, 0x2e
	sb t0, 195
	li t0, 0x1c
	sb t0, 196
	li t0, 0xa6
	sb t0, 197
	li t0, 0xb4
	sb t0, 198
	li t0, 0xc6
	sb t0, 199
	li t0, 0xe8
	sb t0, 200
	li t0, 0xdd
	sb t0, 201
	li t0, 0x74
	sb t0, 202
	li t0, 0x1f
	sb t0, 203
	li t0, 0x4b
	sb t0, 204
	li t0, 0xbd
	sb t0, 205
	li t0, 0x8b
	sb t0, 206
	li t0, 0x8a
	sb t0, 207
	li t0, 0x70
	sb t0, 208
	li t0, 0x3e
	sb t0, 209
	li t0, 0xb5
	sb t0, 210
	li t0, 0x66
	sb t0, 211
	li t0, 0x48
	sb t0, 212
	li t0, 0x3
	sb t0, 213
	li t0, 0xf6
	sb t0, 214
	li t0, 0xe
	sb t0, 215
	li t0, 0x61
	sb t0, 216
	li t0, 0x35
	sb t0, 217
	li t0, 0x57
	sb t0, 218
	li t0, 0xb9
	sb t0, 219
	li t0, 0x86
	sb t0, 220
	li t0, 0xc1
	sb t0, 221
	li t0, 0x1d
	sb t0, 222
	li t0, 0x9e
	sb t0, 223
	li t0, 0xe1
	sb t0, 224
	li t0, 0xf8
	sb t0, 225
	li t0, 0x98
	sb t0, 226
	li t0, 0x11
	sb t0, 227
	li t0, 0x69
	sb t0, 228
	li t0, 0xd9
	sb t0, 229
	li t0, 0x8e
	sb t0, 230
	li t0, 0x94
	sb t0, 231
	li t0, 0x9b
	sb t0, 232
	li t0, 0x1e
	sb t0, 233
	li t0, 0x87
	sb t0, 234
	li t0, 0xe9
	sb t0, 235
	li t0, 0xce
	sb t0, 236
	li t0, 0x55
	sb t0, 237
	li t0, 0x28
	sb t0, 238
	li t0, 0xdf
	sb t0, 239
	li t0, 0x8c
	sb t0, 240
	li t0, 0xa1
	sb t0, 241
	li t0, 0x89
	sb t0, 242
	li t0, 0xd
	sb t0, 243
	li t0, 0xbf
	sb t0, 244
	li t0, 0xe6
	sb t0, 245
	li t0, 0x42
	sb t0, 246
	li t0, 0x68
	sb t0, 247
	li t0, 0x41
	sb t0, 248
	li t0, 0x99
	sb t0, 249
	li t0, 0x2d
	sb t0, 250
	li t0, 0xf
	sb t0, 251
	li t0, 0xb0
	sb t0, 252
	li t0, 0x54
	sb t0, 253
	li t0, 0xbb
	sb t0, 254
	li t0, 0x16
	sb t0, 255
	
addi a1, zero, 5    # rs1
addi a2, zero, 8    # rs2
addi a3, zero, 2    # bs

slli a3, a3, 3      #  shamt = bs @ 0b000

srl  a4, a2, a3     # (X(rs2)[31..0] >> shamt)
andi a4, a4, 255    # si = (X(rs2)[31..0] >> shamt)[7..0]

lb a5, (a4)         # so = 0x000000 @ aes_sbox_fwd(si)

# rol32(so, unsigned(shamt))
andi t0, a3, 31      # shamt = X(rs2)[4..0]
sll t2, a5, t0      # (X(rs1) << shamt)
addi t1, zero, 32   # xlen
sub t1, t1, t0      # (xlen - shamt)
srl t1, a5, t1      # (X(rs1) >> (xlen - shamt))
or a0, t2, t1

xor a0, a1, a0      # result = X(rs1)[31..0] ^ rol32(so, unsigned(shamt))

loop:
   j loop
